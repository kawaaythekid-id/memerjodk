-- Ultimate 30-in-1 LocalScript (Android Friendly, Updated)
local Players = game:GetService("Players")
local Player = Players.LocalPlayer
local RunService = game:GetService("RunService")
local UIS = game:GetService("UserInputService")
local Lighting = game:GetService("Lighting")
local Workspace = game:GetService("Workspace")

-- ===== GUI =====
local ScreenGui = Instance.new("ScreenGui")
ScreenGui.Name = "UltimateScriptsGUI"
ScreenGui.Parent = Player:WaitForChild("PlayerGui")

local scrollingFrame = Instance.new("ScrollingFrame")
scrollingFrame.Size = UDim2.new(0, 220, 0, 600)
scrollingFrame.Position = UDim2.new(0, 10, 0, 10)
scrollingFrame.CanvasSize = UDim2.new(0,0,0,0)
scrollingFrame.ScrollBarThickness = 10
scrollingFrame.Parent = ScreenGui

-- ===== Daftar Fungsi =====
local connections = {} -- Untuk menyimpan RenderStepped connections
local scriptList = {
    {Name="WalkSpeed", Action=function(state)
        if Player.Character and Player.Character:FindFirstChild("Humanoid") then
            Player.Character.Humanoid.WalkSpeed = state and 50 or 16
        end
    end},
    {Name="JumpBoost", Action=function(state)
        if Player.Character and Player.Character:FindFirstChild("Humanoid") then
            Player.Character.Humanoid.JumpPower = state and 100 or 50
        end
    end},
    {Name="Fly", Action=function(state)
        local char = Player.Character
        if not char then return end
        local hrp = char:FindFirstChild("HumanoidRootPart")
        if not hrp then return end
        if state then
            -- Buat Fly dengan BodyVelocity
            local bv = Instance.new("BodyVelocity")
            bv.Velocity = Vector3.new(0,0,0)
            bv.MaxForce = Vector3.new(0,0,0)
            bv.Name = "FlyVelocity"
            bv.Parent = hrp
            bv.MaxForce = Vector3.new(400000,400000,400000)
        else
            local bv = hrp:FindFirstChild("FlyVelocity")
            if bv then bv:Destroy() end
        end
    end},
    {Name="NoClip", Action=function(state)
        local function noclipChar(char)
            for _, part in pairs(char:GetDescendants()) do
                if part:IsA("BasePart") then
                    part.CanCollide = not state
                end
            end
        end
        if Player.Character then noclipChar(Player.Character) end
        Player.CharacterAdded:Connect(function(char)
            noclipChar(char)
        end)
    end},
    {Name="InfiniteJump", Action=function(state)
        -- Event khusus handled di bawah
    end},
    {Name="FullBright", Action=function(state)
        Lighting.Brightness = state and 2 or 1
    end},
    {Name="AntiFallDamage", Action=function(state)
        if Player.Character and Player.Character:FindFirstChild("Humanoid") then
            Player.Character.Humanoid:SetStateEnabled(Enum.HumanoidStateType.Freefall, not state)
        end
    end},
    {Name="ESP", Action=function(state)
        for _, plr in pairs(Players:GetPlayers()) do
            if plr ~= Player then
                if state and plr.Character then
                    local highlight = Instance.new("Highlight")
                    highlight.Name = "ESPHighlight"
                    highlight.Adornee = plr.Character
                    highlight.Parent = plr.Character
                else
                    local h = plr.Character and plr.Character:FindFirstChild("ESPHighlight")
                    if h then h:Destroy() end
                end
            end
        end
    end},
    {Name="AutoCollectItems", Action=function(state)
        if connections["AutoCollectItems"] then connections["AutoCollectItems"]:Disconnect() end
        if state then
            connections["AutoCollectItems"] = RunService.RenderStepped:Connect(function()
                if Player.Character and Player.Character:FindFirstChild("HumanoidRootPart") then
                    local hrp = Player.Character.HumanoidRootPart
                    for _, item in pairs(Workspace:GetChildren()) do
                        if item:IsA("BasePart") and (item.Position - hrp.Position).Magnitude < 20 then
                            item.CFrame = hrp.CFrame
                        end
                    end
                end
            end)
        end
    end},
    {Name="AutoHeal", Action=function(state)
        if connections["AutoHeal"] then connections["AutoHeal"]:Disconnect() end
        if state then
            connections["AutoHeal"] = RunService.RenderStepped:Connect(function()
                if Player.Character and Player.Character:FindFirstChild("Humanoid") then
                    Player.Character.Humanoid.Health = Player.Character.Humanoid.MaxHealth
                end
            end)
        end
    end},
    {Name="WalkOnAir", Action=function(state)
        if connections["WalkOnAir"] then connections["WalkOnAir"]:Disconnect() end
        if state then
            connections["WalkOnAir"] = RunService.RenderStepped:Connect(function()
                if Player.Character and Player.Character:FindFirstChild("HumanoidRootPart") then
                    local hrp = Player.Character.HumanoidRootPart
                    hrp.Velocity = Vector3.new(hrp.Velocity.X,0,hrp.Velocity.Z)
                    hrp.Position = Vector3.new(hrp.Position.X, 5, hrp.Position.Z)
                end
            end)
        end
    end},
    {Name="Invisibility", Action=function(state)
        local function invisChar(char)
            for _, part in pairs(char:GetDescendants()) do
                if part:IsA("BasePart") then
                    part.Transparency = state and 1 or 0
                end
            end
        end
        if Player.Character then invisChar(Player.Character) end
        Player.CharacterAdded:Connect(function(char)
            invisChar(char)
        end)
    end},
    {Name="SpeedHack", Action=function(state)
        if Player.Character and Player.Character:FindFirstChild("Humanoid") then
            Player.Character.Humanoid.WalkSpeed = state and 100 or 16
        end
    end},
}

-- ===== Create GUI per Script =====
local frameHeight = 70
for i, data in ipairs(scriptList) do
    local Frame = Instance.new("Frame", scrollingFrame)
    Frame.Size = UDim2.new(0,200,0,frameHeight)
    Frame.Position = UDim2.new(0,10,0,(i-1)*(frameHeight+5))
    Frame.BackgroundColor3 = Color3.fromRGB(30,30,30)

    local Title = Instance.new("TextLabel", Frame)
    Title.Size = UDim2.new(1,-60,0,25)
    Title.Position = UDim2.new(0,0,0,0)
    Title.BackgroundTransparency = 1
    Title.Text = data.Name
    Title.TextColor3 = Color3.new(1,1,1)

    local MinimizeButton = Instance.new("TextButton", Frame)
    MinimizeButton.Size = UDim2.new(0,50,0,25)
    MinimizeButton.Position = UDim2.new(1,-50,0,0)
    MinimizeButton.Text = "_"

    local ToggleButton = Instance.new("TextButton", Frame)
    ToggleButton.Size = UDim2.new(1,-20,0,35)
    ToggleButton.Position = UDim2.new(0,10,0,30)
    ToggleButton.Text = "OFF"

    local enabled = false
    MinimizeButton.MouseButton1Click:Connect(function()
        Frame.Size = UDim2.new(0,200,0,25)
    end)
    ToggleButton.MouseButton1Click:Connect(function()
        enabled = not enabled
        ToggleButton.Text = enabled and "ON" or "OFF"
        data.Action(enabled)
    end)

    -- Event khusus InfiniteJump
    if data.Name == "InfiniteJump" then
        UIS.JumpRequest:Connect(function()
            if enabled and Player.Character then
                Player.Character.Humanoid:ChangeState(Enum.HumanoidStateType.Jumping)
            end
        end)
    end
end

-- Update CanvasSize agar scrollable
scrollingFrame.CanvasSize = UDim2.new(0,0,#scriptList*(frameHeight+5))
