-- Ultimate Minimal GUI + Infinity Jump + Full Bright (LocalScript)
-- Tempatkan di StarterPlayerScripts

local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")
local Lighting = game:GetService("Lighting")
local Player = Players.LocalPlayer

-- ===== Variabel =====
local WalkSpeed = 16
local InfinityJumpEnabled = true
local FullBrightEnabled = false

-- Simpan pengaturan asli Lighting
local OriginalLighting = {
    Brightness = Lighting.Brightness,
    ClockTime = Lighting.ClockTime,
    FogEnd = Lighting.FogEnd,
    GlobalShadows = Lighting.GlobalShadows,
    OutdoorAmbient = Lighting.OutdoorAmbient
}

-- ===== GUI =====
local function createGUI()
    local screenGui = Instance.new("ScreenGui")
    screenGui.Name = "MinimalGUI"
    screenGui.ResetOnSpawn = false
    screenGui.Parent = Player:WaitForChild("PlayerGui")

    local frame = Instance.new("Frame")
    frame.Size = UDim2.new(0,150,0,110)
    frame.Position = UDim2.new(0,20,0,20)
    frame.BackgroundColor3 = Color3.fromRGB(30,30,30)
    frame.Parent = screenGui

    local title = Instance.new("TextLabel")
    title.Text = "Ultimate GUI"
    title.Size = UDim2.new(1,0,0,20)
    title.BackgroundTransparency = 1
    title.TextColor3 = Color3.fromRGB(255,255,255)
    title.Font = Enum.Font.GothamBold
    title.TextSize = 14
    title.Parent = frame

    -- Minimize button
    local btnMin = Instance.new("TextButton")
    btnMin.Text = "_"
    btnMin.Size = UDim2.new(0,20,0,20)
    btnMin.Position = UDim2.new(1,-22,0,0)
    btnMin.BackgroundColor3 = Color3.fromRGB(50,50,50)
    btnMin.TextColor3 = Color3.fromRGB(255,255,255)
    btnMin.Font = Enum.Font.GothamBold
    btnMin.TextSize = 14
    btnMin.Parent = frame

    local minimized = false
    btnMin.MouseButton1Click:Connect(function()
        minimized = not minimized
        for _,v in pairs(frame:GetChildren()) do
            if v:IsA("GuiObject") and v ~= title and v ~= btnMin then
                v.Visible = not minimized
            end
        end
        frame.Size = minimized and UDim2.new(0,150,0,20) or UDim2.new(0,150,0,110)
    end)

    -- WalkSpeed slider
    local speedBox = Instance.new("TextBox")
    speedBox.PlaceholderText = "WalkSpeed 1-25"
    speedBox.Size = UDim2.new(1,-10,0,20)
    speedBox.Position = UDim2.new(0,5,0,25)
    speedBox.BackgroundColor3 = Color3.fromRGB(50,50,50)
    speedBox.TextColor3 = Color3.fromRGB(255,255,255)
    speedBox.Font = Enum.Font.Gotham
    speedBox.TextSize = 14
    speedBox.Parent = frame

    local btnSpeed = Instance.new("TextButton")
    btnSpeed.Text = "Set Speed"
    btnSpeed.Size = UDim2.new(1,-10,0,20)
    btnSpeed.Position = UDim2.new(0,5,0,50)
    btnSpeed.BackgroundColor3 = Color3.fromRGB(70,70,70)
    btnSpeed.TextColor3 = Color3.fromRGB(255,255,255)
    btnSpeed.Font = Enum.Font.GothamBold
    btnSpeed.TextSize = 14
    btnSpeed.Parent = frame

    btnSpeed.MouseButton1Click:Connect(function()
        local val = tonumber(speedBox.Text)
        if val and val >=1 and val <=25 then
            WalkSpeed = val
        else
            warn("Masukkan angka antara 1-25!")
        end
    end)

    -- Full Bright toggle
    local btnBright = Instance.new("TextButton")
    btnBright.Text = "Full Bright"
    btnBright.Size = UDim2.new(1,-10,0,20)
    btnBright.Position = UDim2.new(0,5,0,75)
    btnBright.BackgroundColor3 = Color3.fromRGB(0,0,0)
    btnBright.TextColor3 = Color3.fromRGB(255,255,255)
    btnBright.Font = Enum.Font.GothamBold
    btnBright.TextSize = 14
    btnBright.Parent = frame

    btnBright.MouseButton1Click:Connect(function()
        if FullBrightEnabled then
            FullBrightEnabled = false
            Lighting.Brightness = OriginalLighting.Brightness
            Lighting.ClockTime = OriginalLighting.ClockTime
            Lighting.FogEnd = OriginalLighting.FogEnd
            Lighting.GlobalShadows = OriginalLighting.GlobalShadows
            Lighting.OutdoorAmbient = OriginalLighting.OutdoorAmbient
        else
            FullBrightEnabled = true
            Lighting.Brightness = 2
            Lighting.ClockTime = 14
            Lighting.FogEnd = 100000
            Lighting.GlobalShadows = false
            Lighting.OutdoorAmbient = Color3.fromRGB(255,255,255)
        end
    end)

    -- Infinity Jump toggle
    local btnJump = Instance.new("TextButton")
    btnJump.Text = "Infinity Jump"
    btnJump.Size = UDim2.new(1,-10,0,20)
    btnJump.Position = UDim2.new(0,5,0,95)
    btnJump.BackgroundColor3 = Color3.fromRGB(0,0,0)
    btnJump.TextColor3 = Color3.fromRGB(255,255,255)
    btnJump.Font = Enum.Font.GothamBold
    btnJump.TextSize = 14
    btnJump.Parent = frame

    btnJump.MouseButton1Click:Connect(function()
        InfinityJumpEnabled = not InfinityJumpEnabled
        btnJump.Text = InfinityJumpEnabled and "Infinity Jump" or "Disable Jump"
    end)

    -- Drag GUI
    local dragging, dragInput, dragStart, startPos
    title.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
            dragging = true
            dragStart = input.Position
            startPos = frame.Position
            input.Changed:Connect(function()
                if input.UserInputState == Enum.UserInputState.End then
                    dragging = false
                end
            end)
        end
    end)
    title.InputChanged:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch then
            dragInput = input
        end
    end)
    UserInputService.InputChanged:Connect(function(input)
        if input == dragInput and dragging then
            local delta = input.Position - dragStart
            frame.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
        end
    end)
end

-- Buat GUI pertama kali
createGUI()

-- ===== Loop utama =====
RunService.RenderStepped:Connect(function()
    local char = Player.Character
    if char then
        local humanoid = char:FindFirstChild("Humanoid")
        if humanoid then
            humanoid.WalkSpeed = WalkSpeed
        end
    end
end)

-- ===== Infinity Jump =====
UserInputService.JumpRequest:Connect(function()
    if InfinityJumpEnabled then
        local char = Player.Character
        if char then
            local humanoid = char:FindFirstChild("Humanoid")
            if humanoid then
                humanoid:ChangeState(Enum.HumanoidStateType.Jumping)
            end
        end
    end
end)

-- ===== Respawn =====
Player.CharacterAdded:Connect(function()
    wait(0.1)
    if not Player:FindFirstChild("PlayerGui"):FindFirstChild("MinimalGUI") then
        createGUI()
    end
end)
