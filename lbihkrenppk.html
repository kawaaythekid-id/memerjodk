-- GUI Auto Teleport Stabil & Loop
local Players = game:GetService("Players")
local TweenService = game:GetService("TweenService")
local player = Players.LocalPlayer

-- Daftar koordinat teleport
local TELEPORT_POSITIONS = {
    Vector3.new(-694.5, 109.2, 298.0),
    Vector3.new(-674.7, 169.2, 700.6),
    Vector3.new(-681.2, 213.0, 1094.4),
    Vector3.new(-565.3, 201.2, 1332.0),
    Vector3.new(-797.8, 225.2, 1505.6),
    Vector3.new(-433.8, 352.5, 1570.5),
    Vector3.new(275.1, 325.1, 1543.4),
    Vector3.new(625.8, 309.2, 1604.2),
    Vector3.new(892.5, 425.2, 1600.5)
}

local teleporting = false

-- Cek apakah GUI sudah ada
local screenGui = player:WaitForChild("PlayerGui"):FindFirstChild("AutoTeleportGUI")
if not screenGui then
    screenGui = Instance.new("ScreenGui")
    screenGui.Name = "AutoTeleportGUI"
    screenGui.Parent = player:WaitForChild("PlayerGui")
end

-- Fungsi buat kotak dan tombol (hanya sekali)
local function setupGUI()
    if screenGui:FindFirstChild("Box") then return end -- Sudah ada

    local box = Instance.new("Frame")
    box.Name = "Box"
    box.Size = UDim2.new(0, 200, 0, 150)
    box.Position = UDim2.new(0, 50, 0, 50)
    box.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
    box.BorderSizePixel = 2
    box.Parent = screenGui

    local title = Instance.new("TextLabel")
    title.Size = UDim2.new(1, 0, 0, 30)
    title.BackgroundColor3 = Color3.fromRGB(0, 170, 255)
    title.Text = "Auto Teleport"
    title.TextColor3 = Color3.fromRGB(255, 255, 255)
    title.Parent = box

    local startButton = Instance.new("TextButton")
    startButton.Size = UDim2.new(0, 80, 0, 40)
    startButton.Position = UDim2.new(0, 10, 0, 50)
    startButton.Text = "Start"
    startButton.BackgroundColor3 = Color3.fromRGB(0, 255, 0)
    startButton.TextColor3 = Color3.fromRGB(255, 255, 255)
    startButton.Parent = box

    local endButton = Instance.new("TextButton")
    endButton.Size = UDim2.new(0, 80, 0, 40)
    endButton.Position = UDim2.new(0, 110, 0, 50)
    endButton.Text = "End"
    endButton.BackgroundColor3 = Color3.fromRGB(255, 0, 0)
    endButton.TextColor3 = Color3.fromRGB(255, 255, 255)
    endButton.Parent = box

    local minimizeButton = Instance.new("TextButton")
    minimizeButton.Size = UDim2.new(0, 30, 0, 30)
    minimizeButton.Position = UDim2.new(1, -35, 0, 0)
    minimizeButton.Text = "_"
    minimizeButton.BackgroundColor3 = Color3.fromRGB(200, 200, 200)
    minimizeButton.Parent = box

    local contentVisible = true
    minimizeButton.MouseButton1Click:Connect(function()
        contentVisible = not contentVisible
        local tweenInfo = TweenInfo.new(0.3, Enum.EasingStyle.Quad, Enum.EasingDirection.Out)
        if contentVisible then
            local tween = TweenService:Create(box, tweenInfo, {Size = UDim2.new(0, 200, 0, 150)})
            tween:Play()
            tween.Completed:Wait()
            startButton.Visible = true
            endButton.Visible = true
        else
            startButton.Visible = false
            endButton.Visible = false
            local tween = TweenService:Create(box, tweenInfo, {Size = UDim2.new(0, 200, 0, 30)})
            tween:Play()
        end
    end)

    -- Tombol Start
    startButton.MouseButton1Click:Connect(function()
        local character = player.Character
        if character then
            local hrp = character:WaitForChild("HumanoidRootPart")
            if not teleporting then
                teleporting = true
                -- Loop terus-menerus sampai tombol End ditekan
                spawn(function()
                    while teleporting do
                        for _, pos in ipairs(TELEPORT_POSITIONS) do
                            if not teleporting then break end
                            hrp.CFrame = CFrame.new(pos)
                            wait(2.5)
                        end
                    end
                end)
            end
        end
    end)

    -- Tombol End
    endButton.MouseButton1Click:Connect(function()
        teleporting = false
    end)

    -- Dragging box
    local dragging = false
    local dragInput, mousePos, framePos

    title.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 then
            dragging = true
            mousePos = input.Position
            framePos = box.Position
            input.Changed:Connect(function()
                if input.UserInputState == Enum.UserInputState.End then
                    dragging = false
                end
            end)
        end
    end)

    title.InputChanged:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseMovement then
            dragInput = input
        end
    end)

    game:GetService("UserInputService").InputChanged:Connect(function(input)
        if input == dragInput and dragging then
            local delta = input.Position - mousePos
            box.Position = UDim2.new(framePos.X.Scale, framePos.X.Offset + delta.X, framePos.Y.Scale, framePos.Y.Offset + delta.Y)
        end
    end)
end

-- Setup GUI sekali
setupGUI()

-- Pastikan GUI tetap ada dan tombol tetap aktif saat respawn
player.CharacterAdded:Connect(function(char)
    wait(0.1)
    setupGUI()
end)
