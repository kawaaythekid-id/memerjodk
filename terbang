--// LocalScript Fly GUI Android (Analog Control, Max 9999)
-- Taruh di StarterPlayer > StarterPlayerScripts

local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local player = Players.LocalPlayer

local character, root, humanoid
local flying = false
local flySpeed = 50
local MAX_SPEED = 9999
local MIN_SPEED = 0
local INCREMENT = 10
local ascend, descend = false, false

local bodyVelocity
local renderConn

--== GUI ==--
local gui = Instance.new("ScreenGui", player:WaitForChild("PlayerGui"))
gui.Name = "FlyGUIv3"
gui.ResetOnSpawn = false

local frame = Instance.new("Frame", gui)
frame.Size = UDim2.new(0, 260, 0, 280)
frame.Position = UDim2.new(0.05, 0, 0.5, -140)
frame.BackgroundColor3 = Color3.fromRGB(20, 20, 20)
frame.BackgroundTransparency = 0.2
frame.BorderSizePixel = 0
frame.Active = true
frame.Draggable = true

local function corner(p)
	local c = Instance.new("UICorner")
	c.CornerRadius = UDim.new(0, 10)
	c.Parent = p
end
corner(frame)

local title = Instance.new("TextLabel", frame)
title.Text = "Fly Controller"
title.Size = UDim2.new(1, -70, 0, 30)
title.Position = UDim2.new(0, 10, 0, 0)
title.BackgroundTransparency = 1
title.TextColor3 = Color3.new(1,1,1)
title.Font = Enum.Font.GothamBold
title.TextSize = 16
title.TextXAlignment = Enum.TextXAlignment.Left

local minimize = Instance.new("TextButton", frame)
minimize.Size = UDim2.new(0,30,0,30)
minimize.Position = UDim2.new(1,-60,0,0)
minimize.Text = "-"
minimize.BackgroundColor3 = Color3.fromRGB(255,170,0)
minimize.TextColor3 = Color3.new(0,0,0)
minimize.TextScaled = true
corner(minimize)

local close = Instance.new("TextButton", frame)
close.Size = UDim2.new(0,30,0,30)
close.Position = UDim2.new(1,-30,0,0)
close.Text = "X"
close.BackgroundColor3 = Color3.fromRGB(255,0,0)
close.TextColor3 = Color3.new(1,1,1)
close.TextScaled = true
corner(close)

local flyBtn = Instance.new("TextButton", frame)
flyBtn.Size = UDim2.new(0,230,0,40)
flyBtn.Position = UDim2.new(0.5,-115,0,40)
flyBtn.Text = "Fly: OFF"
flyBtn.BackgroundColor3 = Color3.fromRGB(200,50,50)
flyBtn.TextColor3 = Color3.new(1,1,1)
flyBtn.Font = Enum.Font.GothamBold
flyBtn.TextSize = 20
corner(flyBtn)

local addBtn = Instance.new("TextButton", frame)
addBtn.Size = UDim2.new(0,50,0,40)
addBtn.Position = UDim2.new(0.1,0,0,100)
addBtn.Text = "+"
addBtn.BackgroundColor3 = Color3.fromRGB(0,200,0)
addBtn.TextColor3 = Color3.new(1,1,1)
addBtn.TextScaled = true
corner(addBtn)

local subBtn = Instance.new("TextButton", frame)
subBtn.Size = UDim2.new(0,50,0,40)
subBtn.Position = UDim2.new(0.5,-25,0,100)
subBtn.Text = "-"
subBtn.BackgroundColor3 = Color3.fromRGB(200,0,0)
subBtn.TextColor3 = Color3.new(1,1,1)
subBtn.TextScaled = true
corner(subBtn)

local speedBox = Instance.new("TextBox", frame)
speedBox.Size = UDim2.new(0,100,0,40)
speedBox.Position = UDim2.new(0.5,60,0,100)
speedBox.Text = tostring(flySpeed)
speedBox.PlaceholderText = "Speed"
speedBox.BackgroundColor3 = Color3.fromRGB(30,30,30)
speedBox.TextColor3 = Color3.new(1,1,1)
speedBox.Font = Enum.Font.Gotham
speedBox.TextScaled = true
corner(speedBox)

-- tombol naik/turun
local upBtn = Instance.new("TextButton", frame)
upBtn.Size = UDim2.new(0,100,0,40)
upBtn.Position = UDim2.new(0.15,0,0,170)
upBtn.Text = "⬆️ Naik"
upBtn.BackgroundColor3 = Color3.fromRGB(80,170,255)
upBtn.TextColor3 = Color3.new(1,1,1)
upBtn.TextScaled = true
corner(upBtn)

local downBtn = Instance.new("TextButton", frame)
downBtn.Size = UDim2.new(0,100,0,40)
downBtn.Position = UDim2.new(0.55,0,0,170)
downBtn.Text = "⬇️ Turun"
downBtn.BackgroundColor3 = Color3.fromRGB(80,80,255)
downBtn.TextColor3 = Color3.new(1,1,1)
downBtn.TextScaled = true
corner(downBtn)

--== Fly Core ==--
local function startFly()
	character = player.Character or player.CharacterAdded:Wait()
	root = character:WaitForChild("HumanoidRootPart")
	humanoid = character:FindFirstChildOfClass("Humanoid")

	-- Nonaktifkan gravitasi
	if humanoid then
		humanoid.PlatformStand = true
	end

	-- Tambahkan BodyVelocity
	bodyVelocity = Instance.new("BodyVelocity")
	bodyVelocity.MaxForce = Vector3.new(1e6, 1e6, 1e6)
	bodyVelocity.Velocity = Vector3.zero
	bodyVelocity.Parent = root

	renderConn = RunService.RenderStepped:Connect(function()
		if not flying or not bodyVelocity then return end

		-- arah dari analog Roblox (MoveDirection)
		local dir = humanoid.MoveDirection
		local moveVec = dir * flySpeed

		-- naik turun manual
		if ascend then
			moveVec += Vector3.new(0, flySpeed, 0)
		elseif descend then
			moveVec += Vector3.new(0, -flySpeed, 0)
		end

		bodyVelocity.Velocity = moveVec
	end)
end

local function stopFly()
	if renderConn then renderConn:Disconnect() renderConn = nil end
	if bodyVelocity then bodyVelocity:Destroy() bodyVelocity = nil end
	if humanoid then humanoid.PlatformStand = false end
end

--== Tombol ==--
flyBtn.MouseButton1Click:Connect(function()
	flying = not flying
	if flying then
		startFly()
		flyBtn.Text = "Fly: ON"
		flyBtn.BackgroundColor3 = Color3.fromRGB(50,200,50)
	else
		stopFly()
		flyBtn.Text = "Fly: OFF"
		flyBtn.BackgroundColor3 = Color3.fromRGB(200,50,50)
	end
end)

addBtn.MouseButton1Click:Connect(function()
	flySpeed = math.clamp(flySpeed + INCREMENT, MIN_SPEED, MAX_SPEED)
	speedBox.Text = tostring(flySpeed)
end)

subBtn.MouseButton1Click:Connect(function()
	flySpeed = math.clamp(flySpeed - INCREMENT, MIN_SPEED, MAX_SPEED)
	speedBox.Text = tostring(flySpeed)
end)

speedBox.FocusLost:Connect(function()
	local n = tonumber(speedBox.Text)
	if n then
		flySpeed = math.clamp(n, MIN_SPEED, MAX_SPEED)
		speedBox.Text = tostring(flySpeed)
	else
		speedBox.Text = tostring(flySpeed)
	end
end)

upBtn.MouseButton1Down:Connect(function() ascend = true end)
upBtn.MouseButton1Up:Connect(function() ascend = false end)
downBtn.MouseButton1Down:Connect(function() descend = true end)
downBtn.MouseButton1Up:Connect(function() descend = false end)

--== Minimize dan Close ==--
local minimized = false
minimize.MouseButton1Click:Connect(function()
	minimized = not minimized
	for _, v in ipairs(frame:GetChildren()) do
		if (v:IsA("TextButton") or v:IsA("TextBox")) and v ~= minimize and v ~= close then
			v.Visible = not minimized
		end
	end
end)
close.MouseButton1Click:Connect(function()
	gui:Destroy()
	stopFly()
end)

print("✅ Fly GUI v3 aktif (Analog arah, max speed 9999).")
